<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìœ ëª…ì»¤íŠ¼ë¸”ë¼ì¸ë“œ</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        (function(){
            emailjs.init("YOUR_PUBLIC_KEY"); // EmailJS ê³µê°œ í‚¤ë¥¼ ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš”
        })();
    </script>
    <style>
        .main-visual {
            position: relative;
            width: 100%;
            height: 500px;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .main-visual img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.8);
            display: block;
        }

        .main-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: white;
            z-index: 10;
            width: 90%;
        }

        .main-text h2 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .main-text p {
            font-size: 1.2rem;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }

        /* ëª¨ë°”ì¼ ìµœì í™” */
        @media (max-width: 768px) {
            .main-visual {
                height: 400px;
            }

            .main-text h2 {
                font-size: 1.8rem;
                margin-bottom: 10px;
            }

            .main-text p {
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .main-visual {
                height: 300px;
            }

            .main-text h2 {
                font-size: 1.4rem;
            }

            .main-text p {
                font-size: 0.9rem;
            }
        }

        .features {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            padding: 40px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .feature-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .feature-item img {
            width: 100%;
            height: 250px;
            object-fit: cover;
        }

        .feature-text {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
        }

        .feature-text h3 {
            margin: 0 0 5px 0;
            font-size: 1.2em;
        }

        .feature-text p {
            margin: 0;
            font-size: 0.9em;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-storage-compat.js"></script>

    <script>
    const firebaseConfig = {
    apiKey: "AIzaSyCM8IflmHHgMaFseEoPPsECsLxsSAjj1Vw",
    authDomain: "curtainweb.firebaseapp.com",
    projectId: "curtainweb",
    storageBucket: "curtainweb.firebasestorage.app",
    messagingSenderId: "1004027071653",
    appId: "1:1004027071653:web:f29be419700c6302b6114c"
  };

    // Firebase ì´ˆê¸°í™”
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
    console.log('âœ… Firebase ì´ˆê¸°í™” ì™„ë£Œ');
    </script>

    <header class="header">
        <div class="container">
            <h1><a href="index.html" class="logo-text">ìœ ëª…ì»¤íŠ¼ë¸”ë¼ì¸ë“œ</a></h1>
            <nav>
                <ul class="nav-menu">
                    <li><a href="pages/curtains.html">ì»¤íŠ¼</a></li>
                    <li><a href="pages/blinds.html">ë¸”ë¼ì¸ë“œ</a></li>
                    <li><a href="pages/portfolio.html">ì‹œê³µì‚¬ë¡€</a></li>
                    <li><a href="pages/contact.html">ìƒë‹´ì‹ ì²­</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <section class="main-visual">
            <div class="main-visual">
                <img id="mainImage" style="display: none;" alt="ë©”ì¸ ë¹„ì£¼ì–¼">
                <div class="main-text">
                    <h2 id="mainTitle">í”„ë¦¬ë¯¸ì—„ ì»¤íŠ¼ìœ¼ë¡œ íŠ¹ë³„í•œ ê³µê°„ì„ ë§Œë“­ë‹ˆë‹¤</h2>
                    <p id="mainSubtitle">ê³ ê°ë‹˜ì˜ ê³µê°„ì— ì–´ìš¸ë¦¬ëŠ” ë§ì¶¤í˜• ë””ìì¸ì„ ì œì•ˆí•´ë“œë¦½ë‹ˆë‹¤</p>
                </div>
            </div>
        </section>

        <section id="products" class="products">
            <div class="container">
                <h3 class="section-title">ì¸ê¸° ì œí’ˆ</h3>
                <div class="product-slider-wrapper">
                    <button class="slider-btn prev" onclick="moveSlide(-1)">â®</button>
                    <div class="product-slider" id="productGrid">
                        <p style="text-align: center; color: #999;">ì œí’ˆì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
                    </div>
                    <button class="slider-btn next" onclick="moveSlide(1)">â¯</button>
                </div>
            </div>
        </section>

        <section id="contact" class="contact">
            <div class="container">
                <h3>ë¬´ë£Œ ë°©ë¬¸ê²¬ì  ìƒë‹´ì‹ ì²­</h3>
                <form id="contactForm" class="contact-form">
                    <input type="text" name="name" placeholder="ì´ë¦„" required>
                    <input type="tel" name="phone" placeholder="ì—°ë½ì²˜" required>
                    <input type="text" name="address" placeholder="ì£¼ì†Œ" required>
                    <textarea name="message" placeholder="ë¬¸ì˜ì‚¬í•­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" required></textarea>
                    <button type="submit">ì‹ ì²­í•˜ê¸°</button>
                </form>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="company-info">
                <p>ìƒí˜¸: ìœ ëª…ì»¤íŠ¼ë¸”ë¼ì¸ë“œ | ëŒ€í‘œ:ê¹€ë„ë²”</p>
                <p>ëŒ€í‘œë²ˆí˜¸: 02-588-2389</p>
                <p>ì£¼ì†Œ:ì„œìš¸ì‹œ ì„œì´ˆêµ¬ ë°©ë°°ì²œë¡œ 16ê¸¸ 18.</p>
                <div class="admin-access">
                    <button onclick="location.href='admin/login.html'" class="admin-btn">
                        ê´€ë¦¬ì
                    </button>
                </div>
            </div>
        </div>
    </footer>

    <div id="adminModal" 
         style="display: none; 
                position: fixed; 
                top: 50%; 
                left: 50%; 
                transform: translate(-50%, -50%); 
                background: white; 
                padding: 20px; 
                border-radius: 8px; 
                box-shadow: 0 0 10px rgba(0,0,0,0.1); 
                z-index: 1000;">
        <h3 style="margin-bottom: 15px;">ê´€ë¦¬ì ë¡œê·¸ì¸</h3>
        <form id="adminLoginForm" style="display: flex; flex-direction: column; gap: 10px;">
            <input type="text" id="adminId" placeholder="ì•„ì´ë””" required 
                   style="padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
            <input type="password" id="adminPw" placeholder="ë¹„ë°€ë²ˆí˜¸" required 
                   style="padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
            <button type="submit" 
                    style="padding: 8px; background: #333; color: white; border: none; border-radius: 4px; cursor: pointer;">
                ë¡œê·¸ì¸
            </button>
            <button type="button" onclick="closeAdminModal()" 
                    style="padding: 8px; background: #ddd; border: none; border-radius: 4px; cursor: pointer;">
                ì·¨ì†Œ
            </button>
        </form>
    </div>

    <div id="modalOverlay" 
         style="display: none; 
                position: fixed; 
                top: 0; 
                left: 0; 
                width: 100%; 
                height: 100%; 
                background: rgba(0,0,0,0.5); 
                z-index: 999;">
    </div>

    <script src="js/main.js"></script>
    <script>
        function showAdminLogin() {
            const modal = document.getElementById('adminModal');
            const overlay = document.getElementById('modalOverlay');
            if (modal && overlay) {
                modal.style.display = 'block';
                overlay.style.display = 'block';
            }
        }

        function closeAdminModal() {
            const modal = document.getElementById('adminModal');
            const overlay = document.getElementById('modalOverlay');
            if (modal && overlay) {
                modal.style.display = 'none';
                overlay.style.display = 'none';
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
        window.addEventListener('DOMContentLoaded', function() {
            // ê´€ë¦¬ì ë¡œê·¸ì¸ í¼
            const adminLoginForm = document.getElementById('adminLoginForm');
            if (adminLoginForm) {
                adminLoginForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const id = document.getElementById('adminId').value;
                    const pw = document.getElementById('adminPw').value;

                    if(id === 'admin' && pw === '1234') {
                        alert('ê´€ë¦¬ì ë¡œê·¸ì¸ ì„±ê³µ!');
                        window.location.href = 'admin/dashboard.html';
                    } else {
                        alert('ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    }
                });
            }

            // ëª¨ë‹¬ ì˜¤ë²„ë ˆì´ í´ë¦­ ì‹œ ë‹«ê¸°
            const modalOverlay = document.getElementById('modalOverlay');
            if (modalOverlay) {
                modalOverlay.addEventListener('click', closeAdminModal);
            }
        });

        // ë©”ì¸ ì´ë¯¸ì§€ ë¡œë“œ
        async function loadMainImage() {
            console.log('ğŸ” ë©”ì¸ ì´ë¯¸ì§€ ë¡œë“œ ì‹œì‘');
            try {
                const snapshot = await db.collection('main-images').limit(1).get();
                console.log('ğŸ“¸ ì´ë¯¸ì§€ ê°œìˆ˜:', snapshot.size);
                
                if (!snapshot.empty) {
                    const imageData = snapshot.docs[0].data();
                    const imgElement = document.getElementById('mainImage');
                    
                    console.log('âœ… ì´ë¯¸ì§€ URL:', imageData.imageUrl);
                    
                    imgElement.src = imageData.imageUrl;
                    imgElement.style.display = 'block';
                } else {
                    console.log('âŒ ë“±ë¡ëœ ì´ë¯¸ì§€ ì—†ìŒ');
                }
            } catch (error) {
                console.error('âŒ ë©”ì¸ ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // ì¸ê¸° ì œí’ˆ ë¡œë“œ
        async function loadProducts() {
            console.log('ğŸ” ì œí’ˆ ë¡œë“œ ì‹œì‘');
            try {
                const snapshot = await db.collection('products')
                    .where('isPopular', '==', true)
                    .limit(3)
                    .get();
                
                console.log('ğŸ›ï¸ ì¸ê¸° ì œí’ˆ ê°œìˆ˜:', snapshot.size);
                
                const productGrid = document.getElementById('productGrid');
                
                if (snapshot.empty) {
                    // ì¸ê¸° ì œí’ˆì´ ì—†ìœ¼ë©´ ì¼ë°˜ ì œí’ˆ 3ê°œ ê°€ì ¸ì˜¤ê¸°
                    const allProducts = await db.collection('products').limit(3).get();
                    
                    if (allProducts.empty) {
                        productGrid.innerHTML = '<p style="text-align: center; color: #999;">ë“±ë¡ëœ ì œí’ˆì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                        return;
                    }
                    
                    productGrid.innerHTML = '';
                    allProducts.forEach(doc => {
                        const product = doc.data();
                        addProductCard(product, doc.id);
                    });
                } else {
                    productGrid.innerHTML = '';
                    snapshot.forEach(doc => {
                        const product = doc.data();
                        addProductCard(product, doc.id);
                    });
                }
            } catch (error) {
                console.error('âŒ ì œí’ˆ ë¡œë“œ ì‹¤íŒ¨:', error);
                document.getElementById('productGrid').innerHTML = 
                    '<p style="text-align: center; color: #999;">ì œí’ˆì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</p>';
            }
        }

        // ì œí’ˆ ì¹´ë“œ ì¶”ê°€
        function addProductCard(product, id) {
            const productGrid = document.getElementById('productGrid');
            const card = document.createElement('div');
            card.className = 'product-card';
            card.innerHTML = `
                <img src="${product.imageUrl || 'https://via.placeholder.com/300x200'}" alt="${product.name}">
                <h4>${product.name}</h4>
                <p>${product.description || ''}</p>
                <button class="product-btn" onclick="location.href='pages/product-detail.html?id=${id}'">ìƒì„¸ë³´ê¸°</button>
            `;
            productGrid.appendChild(card);
        }

        // ìŠ¬ë¼ì´ë” ì´ë™ í•¨ìˆ˜
        let currentSlidePosition = 0;
        function moveSlide(direction) {
            const slider = document.getElementById('productGrid');
            const cardWidth = 240; // ì¹´ë“œ ë„ˆë¹„(220px) + gap(20px)
            currentSlidePosition += direction * cardWidth;
            
            const maxScroll = slider.scrollWidth - slider.clientWidth;
            if (currentSlidePosition < 0) {
                currentSlidePosition = 0;
            } else if (currentSlidePosition > maxScroll) {
                currentSlidePosition = maxScroll;
            }
            
            slider.scrollTo({
                left: currentSlidePosition,
                behavior: 'smooth'
            });
        }

        // ìë™ ìŠ¬ë¼ì´ë“œ (4ì´ˆë§ˆë‹¤)
        let autoSlideInterval;
        function startAutoSlide() {
            autoSlideInterval = setInterval(() => {
                const slider = document.getElementById('productGrid');
                const maxScroll = slider.scrollWidth - slider.clientWidth;
                
                if (currentSlidePosition >= maxScroll) {
                    currentSlidePosition = 0;
                } else {
                    currentSlidePosition += 240;
                }
                
                slider.scrollTo({
                    left: currentSlidePosition,
                    behavior: 'smooth'
                });
            }, 4000);
        }

        function stopAutoSlide() {
            if (autoSlideInterval) {
                clearInterval(autoSlideInterval);
            }
        }

        // í…ìŠ¤íŠ¸ ë¡œë“œ
        async function loadTexts() {
            try {
                const doc = await db.collection('site-texts').doc('main').get();
                if (doc.exists) {
                    const data = doc.data();
                    if (data.mainTitle) {
                        document.getElementById('mainTitle').textContent = data.mainTitle;
                    }
                    if (data.mainSubtitle) {
                        document.getElementById('mainSubtitle').textContent = data.mainSubtitle;
                    }
                }
            } catch (error) {
                console.error('í…ìŠ¤íŠ¸ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        window.addEventListener('DOMContentLoaded', function() {
            console.log('=== í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ ===');
            loadMainImage();
            loadProducts().then(() => {
                // ì œí’ˆ ë¡œë“œ ì™„ë£Œ í›„ ìë™ ìŠ¬ë¼ì´ë“œ ì‹œì‘
                setTimeout(startAutoSlide, 1000);
            });
            loadTexts();

            // ìƒë‹´ í¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            const contactForm = document.getElementById('contactForm');
            if (contactForm) {
                contactForm.addEventListener('submit', handleContactSubmit);
            }

            // ìŠ¬ë¼ì´ë”ì— ë§ˆìš°ìŠ¤ ì˜¬ë¦¬ë©´ ìë™ ìŠ¬ë¼ì´ë“œ ì •ì§€
            const productSlider = document.getElementById('productGrid');
            if (productSlider) {
                productSlider.addEventListener('mouseenter', stopAutoSlide);
                productSlider.addEventListener('mouseleave', startAutoSlide);
            }
        });

        // ìƒë‹´ í¼ ì œì¶œ í•¸ë“¤ëŸ¬
        async function handleContactSubmit(e) {
            e.preventDefault();
            const form = e.target;
            const formData = new FormData(form);
            
            // ë²„íŠ¼ ë¹„í™œì„±í™”
            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.textContent = 'ì „ì†¡ ì¤‘...';
            
            try {
                // Firebaseì— ì €ì¥
                await db.collection('inquiries').add({
                    name: formData.get('name'),
                    phone: formData.get('phone'),
                    address: formData.get('address'),
                    message: formData.get('message'),
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                alert('ë¬¸ì˜ê°€ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤. ë¹ ë¥¸ ì‹œì¼ ë‚´ì— ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.');
                form.reset();
            } catch (error) {
                console.error('ë¬¸ì˜ ì ‘ìˆ˜ ì‹¤íŒ¨:', error);
                alert('ë¬¸ì˜ ì ‘ìˆ˜ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
            } finally {
                // ë²„íŠ¼ í™œì„±í™”
                submitBtn.disabled = false;
                submitBtn.textContent = 'ì‹ ì²­í•˜ê¸°';
            }
        }
    </script>

    <div class="floating-call">
        <a href="tel:02-588-2389" class="call-button">
            <i class="fas fa-phone"></i>
            <span class="call-text">02-588-2389</span>
        </a>
    </div>
</body>
</html>