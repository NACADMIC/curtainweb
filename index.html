<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìœ ëª…ì»¤íŠ¼ë¸”ë¼ì¸ë“œ</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        (function(){
            emailjs.init("YOUR_PUBLIC_KEY"); // EmailJS ê³µê°œ í‚¤ë¥¼ ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš”
        })();
    </script>
    <style>
        .main-visual {
            position: relative;
            width: 100%;
            height: 760px; /* 380pxì˜ ë‘ ë°°ë¡œ ì„¤ì • */
            overflow: hidden;
            margin-bottom: 30px;
        }

        .main-visual img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: brightness(0.8);
        }

        .features {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            padding: 40px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .feature-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .feature-item img {
            width: 100%;
            height: 250px;
            object-fit: cover;
        }

        .feature-text {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
        }

        .feature-text h3 {
            margin: 0 0 5px 0;
            font-size: 1.2em;
        }

        .feature-text p {
            margin: 0;
            font-size: 0.9em;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script>
        // Firebase ì„¤ì • ë° ì´ˆê¸°í™”
        const firebaseConfig = {
            apiKey: "AIzaSyCM8IflmHHgMaFseEoPPsECsLxsSAjj1Vw",
            authDomain: "curtainweb.firebaseapp.com",
            projectId: "curtainweb",
            storageBucket: "curtainweb.firebasestorage.app",
            messagingSenderId: "1004027071653",
            appId: "1:1004027071653:web:f29be419700c6302b6114c"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        
        console.log('âœ… Firebase ì´ˆê¸°í™” ì™„ë£Œ');
    </script>

    <header class="header">
        <div class="container">
            <h1><a href="index.html" class="logo-text">ìœ ëª…ì»¤íŠ¼ë¸”ë¼ì¸ë“œ</a></h1>
            <nav>
                <ul class="nav-menu">
                    <li><a href="pages/curtains.html">ì»¤íŠ¼</a></li>
                    <li><a href="pages/blinds.html">ë¸”ë¼ì¸ë“œ</a></li>
                    <li><a href="pages/portfolio.html">ì‹œê³µì‚¬ë¡€</a></li>
                    <li><a href="pages/contact.html">ìƒë‹´ì‹ ì²­</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main>
        <!-- ë””ë²„ê·¸ ì •ë³´ (í…ŒìŠ¤íŠ¸ìš©) -->
        <div id="debugInfo" style="background: #ffeb3b; padding: 10px; text-align: center; font-weight: bold;">
            ë©”ì¸ ì´ë¯¸ì§€ ë¡œë”© ì¤‘...
        </div>

        <section class="main-visual">
            <img id="mainImage" src="https://images.pexels.com/photos/1082355/pexels-photo-1082355.jpeg" alt="ë©”ì¸ ë¹„ì£¼ì–¼">
            <div class="main-text">
                <h2 id="mainTitle">í”„ë¦¬ë¯¸ì—„ ì»¤íŠ¼ìœ¼ë¡œ íŠ¹ë³„í•œ ê³µê°„ì„ ë§Œë“­ë‹ˆë‹¤</h2>
                <p id="mainDescription">ê³ ê°ë‹˜ì˜ ê°„ì— ì–´ìš¸ë¦¬ëŠ” ë§í˜• ë””ìì¸ì„ ì œì•ˆí•´ë“œë¦½ë‹ˆë‹¤</p>
            </div>
        </section>

        <section id="products" class="products">
            <div class="container">
                <h3 class="section-title">ì¸ê¸° ì œí’ˆ</h3>
                <div class="product-grid" id="productGrid">
                    <!-- Firebaseì—ì„œ ë™ì ìœ¼ë¡œ ë¡œë“œ -->
                    <div class="product-card">
                        <p style="text-align: center; color: #888;">ì œí’ˆ ë¡œë”© ì¤‘...</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="contact" class="contact">
            <div class="container">
                <h3>ë¬´ë£Œ ë°©ë¬¸ê²¬ì  ìƒë‹´ì‹ ì²­</h3>
                <form id="contactForm" class="contact-form">
                    <input type="text" name="name" placeholder="ì´ë¦„" required>
                    <input type="tel" name="phone" placeholder="ì—°ë½ì²˜" required>
                    <input type="text" name="address" placeholder="ì£¼ì†Œ" required>
                    <textarea name="message" placeholder="ë¬¸ì˜ì‚¬í•­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”" required></textarea>
                    <button type="submit">ì‹ ì²­í•˜ê¸°</button>
                </form>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="company-info">
                <p>ìƒí˜¸: ìœ ëª…ì»¤íŠ¼ë¸”ë¼ì¸ë“œ | ëŒ€í‘œ:ê¹€ë„ë²”</p>
                <p>ëŒ€í‘œë²ˆí˜¸: 02-588-2389</p>
                <p>ì£¼ì†Œ:ì„œìš¸ì‹œ ì„œì´ˆêµ¬ ë°©ë°°ì²œë¡œ 16ê¸¸ 18.</p>
                <div class="admin-access">
                    <button onclick="location.href='admin/login.html'" class="admin-btn">
                        ê´€ë¦¬ì
                    </button>
                </div>
            </div>
        </div>
    </footer>

    <div id="adminModal" 
         style="display: none; 
                position: fixed; 
                top: 50%; 
                left: 50%; 
                transform: translate(-50%, -50%); 
                background: white; 
                padding: 20px; 
                border-radius: 8px; 
                box-shadow: 0 0 10px rgba(0,0,0,0.1); 
                z-index: 1000;">
        <h3 style="margin-bottom: 15px;">ê´€ë¦¬ì ë¡œê·¸ì¸</h3>
        <form id="adminLoginForm" style="display: flex; flex-direction: column; gap: 10px;">
            <input type="text" id="adminId" placeholder="ì•„ì´ë””" required 
                   style="padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
            <input type="password" id="adminPw" placeholder="ë¹„ë°€ë²ˆí˜¸" required 
                   style="padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
            <button type="submit" 
                    style="padding: 8px; background: #333; color: white; border: none; border-radius: 4px; cursor: pointer;">
                ë¡œê·¸ì¸
            </button>
            <button type="button" onclick="closeAdminModal()" 
                    style="padding: 8px; background: #ddd; border: none; border-radius: 4px; cursor: pointer;">
                ì·¨ì†Œ
            </button>
        </form>
    </div>

    <div id="modalOverlay" 
         style="display: none; 
                position: fixed; 
                top: 0; 
                left: 0; 
                width: 100%; 
                height: 100%; 
                background: rgba(0,0,0,0.5); 
                z-index: 999;">
    </div>

    <script src="js/main.js"></script>
    <script>
        let logoClickCount = 0;
        document.getElementById('adminAccess').addEventListener('click', function() {
            logoClickCount++;
            if(logoClickCount === 5) {
                window.location.href = '/admin/login.html';
                logoClickCount = 0;
            }
        });

        function showAdminLogin() {
            document.getElementById('adminModal').style.display = 'block';
            document.getElementById('modalOverlay').style.display = 'block';
        }

        function closeAdminModal() {
            document.getElementById('adminModal').style.display = 'none';
            document.getElementById('modalOverlay').style.display = 'none';
        }

        document.getElementById('adminLoginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const id = document.getElementById('adminId').value;
            const pw = document.getElementById('adminPw').value;

            if(id === 'admin' && pw === '1234') {
                alert('ê´€ë¦¬ì ë¡œê·¸ì¸ ì„±ê³µ!');
                window.location.href = 'admin/dashboard.html';
            } else {
                alert('ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        });

        document.getElementById('modalOverlay').addEventListener('click', closeAdminModal);

        // Firebaseì—ì„œ ë©”ì¸ ì´ë¯¸ì§€ ë¡œë“œ
        async function loadMainImage() {
            console.log('=== ë©”ì¸ ì´ë¯¸ì§€ ë¡œë”© ì‹œì‘ ===');
            const img = document.getElementById('mainImage');
            const debugInfo = document.getElementById('debugInfo');
            
            console.log('ì´ë¯¸ì§€ ì—˜ë¦¬ë¨¼íŠ¸:', img);
            console.log('í˜„ì¬ ì´ë¯¸ì§€ src:', img ? img.src : 'null');
            
            try {
                debugInfo.innerHTML = 'Firebase ì—°ê²° ì¤‘...';
                debugInfo.style.background = '#2196F3';
                debugInfo.style.color = 'white';
                
                const snapshot = await db.collection('main-images').get();
                console.log('âœ… Firebase ì‘ë‹µ ì„±ê³µ! ì´ë¯¸ì§€ ìˆ˜:', snapshot.size);
                
                if (!snapshot.empty) {
                    const image = snapshot.docs[0].data();
                    console.log('ğŸ“¸ ì´ë¯¸ì§€ ë°ì´í„°:', JSON.stringify(image));
                    
                    if (img && image.imageUrl) {
                        console.log('ğŸ”„ ì´ë¯¸ì§€ êµì²´ ì‹œë„...');
                        console.log('  ê¸°ì¡´:', img.src);
                        console.log('  ìƒˆê²ƒ:', image.imageUrl);
                        
                        debugInfo.innerHTML = `âœ… ì´ë¯¸ì§€ êµì²´ ì¤‘... ${image.imageUrl}`;
                        debugInfo.style.background = '#4CAF50';
                        
                        // ê°•ì œë¡œ ì´ë¯¸ì§€ êµì²´
                        img.src = image.imageUrl;
                        img.alt = image.title || 'ë©”ì¸ ì´ë¯¸ì§€';
                        
                        console.log('âœ… img.src ì„¤ì • ì™„ë£Œ:', img.src);
                        
                        // ì´ë¯¸ì§€ ë¡œë“œ ì™„ë£Œ í™•ì¸
                        img.onload = function() {
                            console.log('ğŸ‰ ì´ë¯¸ì§€ ë¡œë“œ ì™„ë£Œ!');
                            debugInfo.innerHTML = 'âœ… ì‚¬ìš©ì ì´ë¯¸ì§€ ë¡œë“œ ì™„ë£Œ!';
                            setTimeout(() => {
                                debugInfo.style.display = 'none';
                            }, 3000);
                        };
                        
                        img.onerror = function() {
                            console.error('âŒ ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨!');
                            debugInfo.innerHTML = 'âŒ ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨';
                            debugInfo.style.background = '#f44336';
                        };
                    } else {
                        console.log('âŒ ì´ë¯¸ì§€ ì—˜ë¦¬ë¨¼íŠ¸ ë˜ëŠ” URL ì—†ìŒ');
                        debugInfo.innerHTML = 'âŒ ì´ë¯¸ì§€ URL ì—†ìŒ';
                        debugInfo.style.background = '#f44336';
                    }
                } else {
                    console.log('âš ï¸ Firebaseì— ë“±ë¡ëœ ì´ë¯¸ì§€ ì—†ìŒ');
                    debugInfo.innerHTML = 'âš ï¸ Firebaseì— ì´ë¯¸ì§€ ì—†ìŒ - ê¸°ë³¸ ì´ë¯¸ì§€ í‘œì‹œ';
                    debugInfo.style.background = '#ff9800';
                    setTimeout(() => {
                        debugInfo.style.display = 'none';
                    }, 3000);
                }
            } catch (error) {
                console.error('âŒâŒâŒ ì˜¤ë¥˜ ë°œìƒ:', error);
                console.error('ì˜¤ë¥˜ ìƒì„¸:', error.message);
                console.error('ì˜¤ë¥˜ ìŠ¤íƒ:', error.stack);
                debugInfo.innerHTML = `âŒ ì˜¤ë¥˜: ${error.message}`;
                debugInfo.style.background = '#f44336';
                debugInfo.style.color = 'white';
            }
        }

        // Firebaseì—ì„œ í…ìŠ¤íŠ¸ ë¡œë“œ
        async function loadTexts() {
            try {
                const doc = await db.collection('site-settings').doc('texts').get();
                if (doc.exists) {
                    const data = doc.data();
                    if (data.mainTitle) {
                        document.getElementById('mainTitle').textContent = data.mainTitle;
                    }
                    if (data.mainDescription) {
                        document.getElementById('mainDescription').textContent = data.mainDescription;
                    }
                }
            } catch (error) {
                console.error('í…ìŠ¤íŠ¸ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // Firebaseì—ì„œ ì œí’ˆ ë¡œë“œ
        async function loadProducts() {
            console.log('=== ì œí’ˆ ë¡œë”© ì‹œì‘ ===');
            const productGrid = document.getElementById('productGrid');
            
            try {
                console.log('Firebaseì—ì„œ ì œí’ˆ ì¡°íšŒ ì¤‘...');
                productGrid.innerHTML = '<div class="product-card"><p style="text-align: center;">ì œí’ˆ ë¡œë”© ì¤‘...</p></div>';
                
                const snapshot = await db.collection('products').limit(6).get();
                console.log('âœ… Firebase ì‘ë‹µ ì„±ê³µ! ì œí’ˆ ìˆ˜:', snapshot.size);
                
                if (snapshot.empty) {
                    console.log('âŒ ë“±ë¡ëœ ì œí’ˆ ì—†ìŒ');
                    productGrid.innerHTML = '<div class="product-card"><p style="text-align: center; color: #888;">ë“±ë¡ëœ ì œí’ˆì´ ì—†ìŠµë‹ˆë‹¤.<br>ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ì œí’ˆì„ ë“±ë¡í•˜ì„¸ìš”.</p></div>';
                    return;
                }
                
                productGrid.innerHTML = '';
                
                snapshot.forEach(doc => {
                    const product = doc.data();
                    console.log('ì œí’ˆ:', product.name, product);
                    
                    const card = document.createElement('div');
                    card.className = 'product-card';
                    card.innerHTML = `
                        <img src="${product.imageUrl || 'https://images.unsplash.com/photo-1505692952047-1a78307da8f2'}" alt="${product.name}">
                        <h4>${product.name}</h4>
                        <p>${product.description || (product.category === 'curtain' ? 'ì»¤íŠ¼' : 'ë¸”ë¼ì¸ë“œ')}</p>
                        <button class="product-btn" onclick="location.href='pages/${product.category === 'curtain' ? 'curtains' : 'blinds'}.html'">ìƒì„¸ë³´ê¸°</button>
                    `;
                    productGrid.appendChild(card);
                });
                
                console.log('âœ… ì œí’ˆ ë¡œë”© ì™„ë£Œ!');
            } catch (error) {
                console.error('âŒâŒâŒ ì œí’ˆ ë¡œë“œ ì‹¤íŒ¨:', error);
                console.error('ì˜¤ë¥˜ ìƒì„¸:', error.message);
                productGrid.innerHTML = `<div class="product-card"><p style="text-align: center; color: red;">ì œí’ˆ ë¡œë“œ ì‹¤íŒ¨: ${error.message}</p></div>`;
            }
        }
        
        // í˜ì´ì§€ ì™„ì „íˆ ë¡œë“œ í›„ ì‹¤í–‰
        window.onload = function() {
            console.log('=== í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ ===');
            console.log('Firebase ì—°ê²° ìƒíƒœ:', typeof firebase !== 'undefined' ? 'ì •ìƒ' : 'ì‹¤íŒ¨');
            console.log('DB ê°ì²´:', typeof db !== 'undefined' ? 'ì •ìƒ' : 'ì‹¤íŒ¨');
            
            // ì¦‰ì‹œ ì‹¤í–‰
            loadMainImage();
            loadTexts();
            loadProducts();
        };

        document.getElementById('contactForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const form = e.target;
            const formData = new FormData(form);
            
            // ë²„íŠ¼ ë¹„í™œì„±í™”
            const submitBtn = form.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.textContent = 'ì „ì†¡ ì¤‘...';
            
            try {
                // Firebaseì— ë¬¸ì˜ì‚¬í•­ ì €ì¥
                await db.collection('inquiries').add({
                    name: formData.get('name'),
                    phone: formData.get('phone'),
                    address: formData.get('address'),
                    message: formData.get('message'),
                    read: false,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                alert('ë¬¸ì˜ê°€ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤. ë¹ ë¥¸ ì‹œì¼ ë‚´ì— ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.');
                form.reset();
            } catch (error) {
                console.error('ë¬¸ì˜ ì ‘ìˆ˜ ì‹¤íŒ¨:', error);
                alert('ë¬¸ì˜ ì ‘ìˆ˜ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
            } finally {
                // ë²„íŠ¼ í™œì„±í™”
                submitBtn.disabled = false;
                submitBtn.textContent = 'ì‹ ì²­í•˜ê¸°';
            }
        });
    </script>

    <div class="floating-call">
        <a href="tel:02-588-2389" class="call-button">
            <i class="fas fa-phone"></i>
            <span class="call-text">02-588-2389</span>
        </a>
    </div>
</body>
</html>